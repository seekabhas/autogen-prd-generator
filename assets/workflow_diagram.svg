<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="agentGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4f46e5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="flowGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#00000020"/>
    </filter>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#1f2937">
    Agentic PRD Workflow Architecture
  </text>
  
  <!-- User Interface Layer -->
  <rect x="50" y="60" width="200" height="80" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="2" filter="url(#shadow)"/>
  <text x="150" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1e40af">Frontend Layer</text>
  <text x="150" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#1e40af">Streamlit UI</text>
  <text x="150" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#1e40af">Session Management</text>
  
  <!-- Orchestrator Agent -->
  <rect x="350" y="60" width="160" height="80" rx="10" fill="url(#agentGradient)" stroke="#4338ca" stroke-width="2" filter="url(#shadow)"/>
  <text x="430" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Orchestrator Agent</text>
  <text x="430" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Workflow Coordinator</text>
  <text x="430" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Agent Router</text>
  
  <!-- Intent Classifier -->
  <rect x="100" y="180" width="140" height="70" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
  <text x="170" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#92400e">Intent Classifier</text>
  <text x="170" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">PRD vs Other</text>
  <text x="170" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">Binary Classification</text>
  
  <!-- Conversation Agent -->
  <rect x="280" y="180" width="140" height="70" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2" filter="url(#shadow)"/>
  <text x="350" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#065f46">Conversation Agent</text>
  <text x="350" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#065f46">Requirements Gathering</text>
  <text x="350" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#065f46">ONE Question at a Time</text>
  
  <!-- Research Agent -->
  <rect x="460" y="180" width="140" height="70" rx="8" fill="#fde68a" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
  <text x="530" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#92400e">Research Agent</text>
  <text x="530" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">Market Analysis</text>
  <text x="530" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">Technical Research</text>
  
  <!-- PRD Agent -->
  <rect x="640" y="180" width="140" height="70" rx="8" fill="#e0e7ff" stroke="#6366f1" stroke-width="2" filter="url(#shadow)"/>
  <text x="710" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#4338ca">PRD Agent</text>
  <text x="710" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#4338ca">Document Generation</text>
  <text x="710" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#4338ca">Structured Output</text>
  
  <!-- Ollama LLM Layer -->
  <rect x="850" y="60" width="300" height="190" rx="10" fill="#f3f4f6" stroke="#6b7280" stroke-width="2" filter="url(#shadow)"/>
  <text x="1000" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#374151">LLM Infrastructure</text>
  
  <rect x="870" y="100" width="120" height="50" rx="5" fill="#fecaca" stroke="#ef4444" stroke-width="1"/>
  <text x="930" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#dc2626">Ollama Server</text>
  <text x="930" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">Local LLM</text>
  
  <rect x="1010" y="100" width="120" height="50" rx="5" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1"/>
  <text x="1070" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1d4ed8">Qwen2.5VL:3B</text>
  <text x="1070" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#1d4ed8">Language Model</text>
  
  <rect x="870" y="170" width="120" height="50" rx="5" fill="#c7d2fe" stroke="#6366f1" stroke-width="1"/>
  <text x="930" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#4338ca">AutoGen</text>
  <text x="930" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#4338ca">Framework</text>
  
  <rect x="1010" y="170" width="120" height="50" rx="5" fill="#d1fae5" stroke="#10b981" stroke-width="1"/>
  <text x="1070" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#065f46">OpenAI API</text>
  <text x="1070" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#065f46">Compatible</text>
  
  <!-- Workflow Flow Arrows -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#059669" />
    </marker>
  </defs>
  
  <!-- User to Orchestrator -->
  <line x1="250" y1="100" x2="350" y2="100" stroke="url(#flowGradient)" stroke-width="3" marker-end="url(#arrowhead)"/>
  <text x="300" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#065f46">User Input</text>
  
  <!-- Orchestrator to Agents -->
  <line x1="430" y1="140" x2="170" y2="180" stroke="url(#flowGradient)" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="430" y1="140" x2="350" y2="180" stroke="url(#flowGradient)" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="430" y1="140" x2="530" y2="180" stroke="url(#flowGradient)" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="430" y1="140" x2="710" y2="180" stroke="url(#flowGradient)" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Agents to Ollama -->
  <line x1="780" y1="215" x2="850" y2="155" stroke="#6b7280" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Workflow Stages -->
  <rect x="50" y="300" width="1100" height="200" rx="10" fill="#f9fafb" stroke="#d1d5db" stroke-width="2"/>
  <text x="600" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#374151">Workflow Execution Stages</text>
  
  <!-- Stage 1 -->
  <rect x="80" y="340" width="120" height="140" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="140" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#92400e">Stage 1</text>
  <text x="140" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#92400e">Intent Detection</text>
  <text x="140" y="405" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">• Analyze user input</text>
  <text x="140" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">• Classify as PRD/Other</text>
  <text x="140" y="435" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">• Route to workflow</text>
  <text x="140" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#d97706">Output: "prd" | "other"</text>
  
  <!-- Stage 2 -->
  <rect x="230" y="340" width="120" height="140" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
  <text x="290" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#065f46">Stage 2</text>
  <text x="290" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#065f46">Requirements</text>
  <text x="290" y="405" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#065f46">• Ask focused questions</text>
  <text x="290" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#065f46">• Build conversation</text>
  <text x="290" y="435" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#065f46">• Gather details</text>
  <text x="290" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#059669">Signal: "REQUIREMENTS_COMPLETE"</text>
  
  <!-- Stage 3 -->
  <rect x="380" y="340" width="120" height="140" rx="8" fill="#fde68a" stroke="#f59e0b" stroke-width="2"/>
  <text x="440" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#92400e">Stage 3</text>
  <text x="440" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#92400e">Research</text>
  <text x="440" y="405" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">• Market analysis</text>
  <text x="440" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">• Competitor review</text>
  <text x="440" y="435" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#92400e">• Best practices</text>
  <text x="440" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#d97706">Output: Research Report</text>
  
  <!-- Stage 4 -->
  <rect x="530" y="340" width="120" height="140" rx="8" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
  <text x="590" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4338ca">Stage 4</text>
  <text x="590" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#4338ca">PRD Generation</text>
  <text x="590" y="405" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#4338ca">• Synthesize data</text>
  <text x="590" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#4338ca">• Structure document</text>
  <text x="590" y="435" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#4338ca">• Format output</text>
  <text x="590" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#6366f1">Output: Complete PRD</text>
  
  <!-- Stage 5 -->
  <rect x="680" y="340" width="120" height="140" rx="8" fill="#fecaca" stroke="#ef4444" stroke-width="2"/>
  <text x="740" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#dc2626">Stage 5</text>
  <text x="740" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#dc2626">Post-Completion</text>
  <text x="740" y="405" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#dc2626">• Refinement options</text>
  <text x="740" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#dc2626">• New PRD creation</text>
  <text x="740" y="435" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#dc2626">• User choices</text>
  <text x="740" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#dc2626">Interactive Follow-up</text>
  
  <!-- State Management -->
  <rect x="830" y="340" width="120" height="140" rx="8" fill="#f3f4f6" stroke="#6b7280" stroke-width="2"/>
  <text x="890" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#374151">State Management</text>
  <text x="890" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#374151">• Session tracking</text>
  <text x="890" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#374151">• Message history</text>
  <text x="890" y="415" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#374151">• Stage transitions</text>
  <text x="890" y="430" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#374151">• Error recovery</text>
  <text x="890" y="450" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#6b7280">Streamlit Session State</text>
  
  <!-- Configuration -->
  <rect x="980" y="340" width="120" height="140" rx="8" fill="#ddd6fe" stroke="#8b5cf6" stroke-width="2"/>
  <text x="1040" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#6b21a8">Configuration</text>
  <text x="1040" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#6b21a8">• Model settings</text>
  <text x="1040" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#6b21a8">• API endpoints</text>
  <text x="1040" y="415" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#6b21a8">• Environment vars</text>
  <text x="1040" y="430" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#6b21a8">• Thinking disabled</text>
  <text x="1040" y="450" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#8b5cf6">OLLAMA_VL_CONFIG</text>
  
  <!-- Flow arrows between stages -->
  <line x1="200" y1="410" x2="230" y2="410" stroke="#059669" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="350" y1="410" x2="380" y2="410" stroke="#059669" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="500" y1="410" x2="530" y2="410" stroke="#059669" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="650" y1="410" x2="680" y2="410" stroke="#059669" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Data Flow Indicators -->
  <rect x="50" y="520" width="1100" height="80" rx="10" fill="#ecfdf5" stroke="#10b981" stroke-width="2"/>
  <text x="600" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#065f46">Data Flow & Technology Stack</text>
  
  <text x="100" y="565" font-family="Arial, sans-serif" font-size="12" fill="#065f46">
    <tspan font-weight="bold">Input:</tspan> User Text → 
    <tspan font-weight="bold">Processing:</tspan> Agent Coordination → 
    <tspan font-weight="bold">LLM:</tspan> Qwen2.5VL via Ollama → 
    <tspan font-weight="bold">Output:</tspan> Structured PRD
  </text>
  
  <text x="100" y="585" font-family="Arial, sans-serif" font-size="12" fill="#065f46">
    <tspan font-weight="bold">Tech Stack:</tspan> Streamlit + AutoGen + Ollama + Python | 
    <tspan font-weight="bold">Privacy:</tspan> 100% Local Processing | 
    <tspan font-weight="bold">Performance:</tspan> Thinking Mode Disabled
  </text>
  
  <!-- Legend -->
  <rect x="50" y="720" width="300" height="60" rx="5" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1"/>
  <text x="200" y="740" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1e293b">Legend</text>
  <circle cx="80" cy="755" r="5" fill="#4f46e5"/>
  <text x="95" y="760" font-family="Arial, sans-serif" font-size="11" fill="#1e293b">Agent Component</text>
  <circle cx="200" cy="755" r="5" fill="#059669"/>
  <text x="215" y="760" font-family="Arial, sans-serif" font-size="11" fill="#1e293b">Data Flow</text>
  <circle cx="280" cy="755" r="5" fill="#dc2626"/>
  <text x="295" y="760" font-family="Arial, sans-serif" font-size="11" fill="#1e293b">Infrastructure</text>